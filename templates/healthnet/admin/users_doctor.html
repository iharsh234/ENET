{% extends "base.html" %}
{% load app_filters %}
{% block title %}Manage Users{% endblock %}
{% block sidebar_admin_users_doctor %}active{% endblock %}
{% block body_header %}
    Manage Registered HealthNet Doctors
    <br>
    <a class="btn btn-success btn-sm" href="/admin/createemployee/" role="button">Add Employee</a>
{% endblock %}
{% block body %}
    <table id="datatable" class="table table-hover table-striped table-bordered">
        <thead>
            <th>Username</th>
            <th>Passcode</th>
            <th>First name</th>
            <th>Last name</th>
            <th>Role</th>
            <th>Allowed Patient</th>
        </thead>
        <tbody>
            {% for account in query %}
                <tr>
                    <td>{{ account.user.username }}</td>
                    <td>{{ account.profile.insurance }}</td>
                    <td>{{ account.profile.firstname }}</td>
                    <td>{{ account.profile.lastname }}</td>
                    <td data-value="{{ account.role }}">
                        <form action="./" method="post" class="form-inline">{% csrf_token %}
                            <input type="hidden" name="pk" value="{{ account.pk }}">
                            <select class="form-control" name="role">
                                <option value="10" {% if account.role == 10 %}selected="selected"{% endif %}>Patient</option>
                                <option value="20" {% if account.role == 20 %}selected="selected"{% endif %}>Nurse</option>
                                <option value="30" {% if account.role == 30 %}selected="selected"{% endif %}>Doctor</option>
                                <option value="40" {% if account.role == 40 %}selected="selected"{% endif %}>Admin</option>
                            </select>
                            <input class="btn btn-primary" type="submit" value="Save"/>
                            <script type="text/javascript">
                                function proxy{{ admission.pk }}() {
                                    configureModal({% autoescape on %}
                                            {{ account.pk }},
                                            '{{ account.profile }}'
                                        {% endautoescape %});
                                };
                            </script>
                            <!-- <button onclick="proxy{{ account.pk }}()" type="button" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#form-modal">Discharge</button> -->
                            <input class="btn btn-danger btn-primary" method="GET" type="submit" onclick="return clicked();"  data-toggle="modal" data-target="#form-modal" value="Delete" name="del"/>
                        </form>
                    </td>
                    <td data-value="{{ account.profile.limit_users }}">
                      <form action="./" method="post" class="form-inline">{% csrf_token %}
                          <input type="hidden" name="pk" value="{{ account.pk }}">
                          <input type="hidden" name="pk2" value="{{ account.profile.pk }}">
                          <input type="number" name="limits" class="form-control" value="{{ account.profile.limit_users }}"/>
                          <input class="btn btn-primary" type="submit" value="Save"/>
                      </form>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    <script type="text/javascript">
        $(document).ready(function() {
            $('#datatable').DataTable();
        } );
    </script>
    <script>
        function clicked() {

            return confirm('Are you sure you want to delete');
        }
    </script>

{% endblock %}
